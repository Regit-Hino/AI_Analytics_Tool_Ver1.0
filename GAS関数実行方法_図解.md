# 📖 GAS関数の実行方法（詳細手順）

## 1. Google Apps Scriptエディタを開く

1. https://script.google.com にアクセス
2. 該当のプロジェクトをクリックして開く

## 2. テストコードを追加

### 手順：
1. **既存のコードの下に**、以下のテスト関数を追加（コピー＆ペースト）：

```javascript
// ===== ここから下をコピーして、既存コードの最後に追加 =====

function simpleTest() {
  console.log('テスト実行中...');
  
  try {
    const spreadsheetId = '1-vBChfdpYN1-Sb92jVX5n1FA8eTFH_ztZgQyZCsTwN4';
    const sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('回答一覧');
    
    // テストデータを追加
    sheet.appendRow([
      new Date().toISOString(),
      '手動実行テスト',
      'IT',
      '1-100',
      'テスト太郎',
      'manual-test@example.com',
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      50,
      '★'
    ]);
    
    console.log('✅ 成功！スプレッドシートを確認してください');
  } catch (error) {
    console.error('❌ エラー:', error.toString());
  }
}

// ===== ここまで =====
```

2. **Ctrl+S**（Windows）または **Cmd+S**（Mac）で保存

## 3. 関数を実行する

### 方法A：エディタ上部のツールバーから実行

1. **エディタ上部を見る**
2. **関数選択ドロップダウン**を探す（「実行する関数を選択」と書かれている）
3. ドロップダウンをクリック
4. **「simpleTest」を選択**
5. その横の **▶️ 実行ボタン**をクリック

### 方法B：サイドバーから実行

1. **左側のサイドバー**を見る
2. **「エディタ」タブ**が選択されていることを確認
3. **関数名の左側にある ▶️ ボタン**をクリック

## 4. 初回実行時の権限承認

### 初めて実行する場合：
1. **「承認が必要です」**というポップアップが表示される
2. **「権限を確認」**をクリック
3. **Googleアカウント**を選択
4. **「詳細」**をクリック（左下の小さいリンク）
5. **「安全でないページに移動」**をクリック
6. **「許可」**をクリック

## 5. 実行結果の確認

### コンソールログを見る：
1. **エディタ下部**の「実行ログ」を確認
2. または、**Ctrl+Enter**（Windows）/ **Cmd+Enter**（Mac）で実行ログを開く

### 成功した場合：
```
テスト実行中...
✅ 成功！スプレッドシートを確認してください
```

### エラーの場合：
```
テスト実行中...
❌ エラー: [エラーメッセージ]
```

## 6. よくあるエラーと対処法

### 「Exception: シートが見つかりません」
→ スプレッドシートに「回答一覧」シートを作成してください

### 「Exception: You do not have permission」
→ 権限の承認手順を実行してください

### 「ReferenceError: SpreadsheetApp is not defined」
→ Google Apps Scriptプロジェクトで実行していることを確認

## 7. 実行できない場合の代替方法

エディタで以下の手順：
1. **「実行」メニュー**をクリック（上部メニューバー）
2. **「関数を実行」→「simpleTest」**を選択

## 確認事項

実行後、以下を確認してください：
1. スプレッドシートの「回答一覧」シートに新しい行が追加されているか
2. 追加された行の会社名は「手動実行テスト」になっているか

実行できましたら、結果（成功/エラーメッセージ）を教えてください。