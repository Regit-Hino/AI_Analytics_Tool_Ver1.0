<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>é¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆé€ä¿¡ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            background: #e3f2fd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        button {
            background: #2196F3;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #1976D2;
        }
        .log {
            background: #263238;
            color: #4CAF50;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
            max-height: 500px;
            overflow-y: auto;
            font-size: 14px;
        }
        .important {
            background: #ffeb3b;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <h1>ğŸ“ é¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆé€ä¿¡ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="important">
        âš ï¸ ã“ã®ãƒ†ã‚¹ãƒˆã§ã€é¸æŠè‚¢ã®ãƒ†ã‚­ã‚¹ãƒˆãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
    </div>

    <div class="test-section">
        <h2>é€ä¿¡ã™ã‚‹ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</h2>
        <table>
            <tr>
                <th>è³ªå•ç•ªå·</th>
                <th>é€ä¿¡ã•ã‚Œã‚‹å†…å®¹</th>
            </tr>
            <tr>
                <td>è³ªå•1</td>
                <td>èˆˆå‘³ã¯ã‚ã‚‹ãŒã€ã¾ã è€ƒãˆã¦ã„ãªã„ï¼ˆ3ç‚¹ï¼‰</td>
            </tr>
            <tr>
                <td>è³ªå•6</td>
                <td>åé›†é–‹å§‹ï¼ˆ3ç‚¹ï¼‰</td>
            </tr>
            <tr>
                <td>è³ªå•11</td>
                <td>æ•°ãƒ¶æœˆä»¥å†…ï¼ˆ7ç‚¹ï¼‰</td>
            </tr>
        </table>
    </div>

    <div class="test-section">
        <button onclick="sendTest()">ğŸš€ ãƒ†ã‚¹ãƒˆé€ä¿¡</button>
        <div id="log" class="log"></div>
    </div>

    <script>
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbziuZzkU3S0c_DZKmVrfIRV9YR4U_8EDQR6Ggkq8qcX792IeEcC9Hiyq2OdoK53cc3rPw/exec';
        
        function log(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString('ja-JP');
            logDiv.textContent += `[${time}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function getJSTTimestamp() {
            const now = new Date();
            const jstOffset = 9 * 60;
            const jstTime = new Date(now.getTime() + (jstOffset * 60 * 1000));
            
            const year = jstTime.getUTCFullYear();
            const month = String(jstTime.getUTCMonth() + 1).padStart(2, '0');
            const day = String(jstTime.getUTCDate()).padStart(2, '0');
            const hours = String(jstTime.getUTCHours()).padStart(2, '0');
            const minutes = String(jstTime.getUTCMinutes()).padStart(2, '0');
            const seconds = String(jstTime.getUTCSeconds()).padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }
        
        async function sendTest() {
            log('=== é¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆé€ä¿¡ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            const testData = {
                timestamp: getJSTTimestamp(),
                company: "é¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆãƒ†ã‚¹ãƒˆä¼šç¤¾",
                industry: "IT",
                headcount: "51-100",
                name: "ãƒ†ã‚­ã‚¹ãƒˆå¤ªéƒ",
                email: "text-test@example.com",
                answers: {
                    "1": "èˆˆå‘³ã¯ã‚ã‚‹ãŒã€ã¾ã è€ƒãˆã¦ã„ãªã„ï¼ˆ3ç‚¹ï¼‰",
                    "2": "è¨ˆç”»æ®µéšï¼ˆ1ç‚¹ï¼‰",
                    "3": "æœªè¨­ç½®ï¼ˆ0ç‚¹ï¼‰",
                    "4": "è¨ˆç”»ä¸­ï¼ˆ3ç‚¹ï¼‰",
                    "5": "èˆˆå‘³ã‚‚ã‚ã‚‹ãŒã€ä¸å®‰ã®å£°ã‚‚ã‚ã‚‹ï¼ˆ3ç‚¹ï¼‰",
                    "6": "åé›†é–‹å§‹ï¼ˆ3ç‚¹ï¼‰",
                    "7": "æ‹…å½“è€…ã‚„ãƒ«ãƒ¼ãƒ«ã¯ç‰¹ã«ãªã„ï¼ˆ0ç‚¹ï¼‰",
                    "8": "Excelã§ã¾ã¨ã‚ã¦ã„ã‚‹ãŒæ´»ç”¨ã§ãã¦ã„ãªã„ï¼ˆ3ç‚¹ï¼‰",
                    "9": "å°‚é–€å®¶ã«ä¾é ¼ã—ãŸã„ãŒã€èª°ã«é ¼ã‚ã°ã‚ˆã„ã‹ã‚ã‹ã‚‰ãªã„ï¼ˆ3ç‚¹ï¼‰",
                    "10": "äºˆç®—åŒ–ã•ã‚Œã¦ã„ãªã„ï¼ˆ0ç‚¹ï¼‰",
                    "11": "æ•°ãƒ¶æœˆä»¥å†…ï¼ˆ7ç‚¹ï¼‰",
                    "12": "ç”Ÿç”£æ€§å‘ä¸Šï¼ˆ6ç‚¹ï¼‰",
                    "13": "éå¸¸ã«æœŸå¾…ã—ã¦ã„ã‚‹ï¼ˆ7ç‚¹ï¼‰",
                    "14": "åˆæœŸæŠ•è³‡ã®å¤§ãã•ï¼ˆ7ç‚¹ï¼‰",
                    "15": "åŠ¹æœã®æ¸¬å®šæ–¹æ³•ãŒã‚ã‹ã‚‰ãªã„ï¼ˆ6ç‚¹ï¼‰"
                },
                total_score: 58,
                tier: "â˜…â˜…",
                remarks: "é¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã‹ã®ãƒ†ã‚¹ãƒˆ"
            };
            
            log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:');
            log(JSON.stringify(testData, null, 2));
            log('\né‡è¦: answersãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«é¸æŠè‚¢ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ç‚¹æ•°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼');
            
            try {
                log('\né€ä¿¡ä¸­...');
                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify(testData),
                });
                
                log('âœ… é€ä¿¡å®Œäº†ï¼');
                log('\nğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š');
                log('- ä¼šç¤¾åã€Œé¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆãƒ†ã‚¹ãƒˆä¼šç¤¾ã€ã®è¡Œ');
                log('- Gåˆ—ã€œUåˆ—ã«ã€Œé¸æŠè‚¢ãƒ†ã‚­ã‚¹ãƒˆï¼ˆç‚¹æ•°ï¼‰ã€å½¢å¼ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹');
                log('- ä¾‹: Gåˆ—ã«ã€Œèˆˆå‘³ã¯ã‚ã‚‹ãŒã€ã¾ã è€ƒãˆã¦ã„ãªã„ï¼ˆ3ç‚¹ï¼‰ã€');
                
            } catch (error) {
                log('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message);
            }
        }
    </script>
</body>
</html>