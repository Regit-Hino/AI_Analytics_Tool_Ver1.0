# 🚨 重要：GAS再デプロイ手順

## 問題
コードを更新しても、**再デプロイしないと変更が反映されません**。

## 再デプロイ手順（必須）

### 方法1：既存のデプロイを更新（推奨）

1. **Google Apps Scriptエディタを開く**

2. **右上の「デプロイ」をクリック**

3. **「デプロイを管理」を選択**

4. **既存のデプロイの右側の鉛筆アイコン（編集）をクリック**

5. **設定を確認**
   - 種類：ウェブアプリ
   - 実行ユーザー：自分
   - アクセスできるユーザー：全員

6. **バージョン：「新バージョン」を選択** ← これが重要！

7. **「デプロイ」ボタンをクリック**

8. **URLは変わりません**（同じURLで動作します）

### 方法2：新しいデプロイを作成

1. **「デプロイ」→「新しいデプロイ」**

2. **設定**
   - 種類：ウェブアプリ
   - 説明：任意（例：スプレッドシートID設定済み）
   - 実行ユーザー：自分
   - アクセスできるユーザー：全員

3. **「デプロイ」をクリック**

4. **新しいURLが発行される**
   - このURLを `.env` ファイルの `VITE_SAVE_ENDPOINT` に設定する必要があります

## デプロイ後の確認

### 1. GASエディタでテスト
```javascript
function testDirectSave() {
  try {
    const spreadsheetId = '1-vBChfdpYN1-Sb92jVX5n1FA8eTFH_ztZgQyZCsTwN4';
    const sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('回答一覧');
    
    const testData = [
      new Date().toISOString(),
      "GASテスト",
      "IT",
      "1-100",
      "テスト太郎",
      "test@example.com",
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      50,
      "★"
    ];
    
    sheet.appendRow(testData);
    console.log('✅ 成功！スプレッドシートを確認してください');
  } catch (error) {
    console.error('❌ エラー:', error.toString());
  }
}
```

この関数を実行して、スプレッドシートにデータが追加されるか確認。

### 2. ブラウザでGET確認
デプロイされたURLに直接アクセスして、以下のレスポンスが返ることを確認：
```json
{"status":"ok","message":"Working!"}
```

## トラブルシューティング

### 「承認が必要です」エラー
1. 初回実行時は権限の承認が必要
2. 「権限を確認」→「詳細」→「安全でないページに移動」→「許可」

### 「回答一覧シートが見つかりません」エラー
1. スプレッドシートに「回答一覧」という名前のシートがあるか確認
2. シート名が完全に一致しているか確認（スペースなども含む）

### それでも動かない場合
1. 実行ログを確認（エディタ左側の「実行数」）
2. エラーメッセージを確認
3. スプレッドシートの共有設定を確認（GASからアクセス可能か）