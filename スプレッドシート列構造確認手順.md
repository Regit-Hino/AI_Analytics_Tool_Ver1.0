# スプレッドシート列構造確認手順

## 現在の問題
- remarksがAC列（29列目）ではなくAB列（28列目）に表示される
- 他の項目は正しく表示されている

## 確認手順

### 1. スプレッドシートの現在の列構造を確認

1. Google スプレッドシートを開く
2. 「回答一覧」シートのヘッダー行を確認
3. 各列のタイトルと位置を記録：
   - A列: タイムスタンプ
   - B列: 会社名
   - C列: 業種
   - D列: 従業員数
   - E列: 氏名
   - F列: メールアドレス
   - G-U列: 質問1-15
   - V-Z列: 質問16-20（空欄の場合もある）
   - AA列: 総合得点
   - AB列: 評価
   - AC列: 備考（ここにremarksが表示されるべき）

### 2. 問題の原因特定

以下のいずれかの可能性があります：

#### 可能性1: スプレッドシートの列が28列しかない
- AC列が存在しない場合、GASが29列目にデータを書き込もうとすると、自動的に新しい列が作成されるはずですが、何らかの理由で失敗している可能性があります。

#### 可能性2: 質問16-20の列が存在しない
- 質問が15個しかないのに、GASコードは質問16-20用の空欄を追加しています。
- もしスプレッドシートで質問16-20の列を削除していた場合、列がずれます。

### 3. 推奨される解決方法

## 方法A: スプレッドシートの列を調整（推奨）

1. スプレッドシートを開く
2. 現在の列構造を確認
3. 以下の列構造になるようにヘッダーを調整：

| 列 | ヘッダー |
|---|----------|
| A | タイムスタンプ |
| B | 会社名 |
| C | 業種 |
| D | 従業員数 |
| E | 氏名 |
| F | メールアドレス |
| G | 質問1 |
| H | 質問2 |
| I | 質問3 |
| J | 質問4 |
| K | 質問5 |
| L | 質問6 |
| M | 質問7 |
| N | 質問8 |
| O | 質問9 |
| P | 質問10 |
| Q | 質問11 |
| R | 質問12 |
| S | 質問13 |
| T | 質問14 |
| U | 質問15 |
| V | 質問16 |
| W | 質問17 |
| X | 質問18 |
| Y | 質問19 |
| Z | 質問20 |
| AA | 総合得点 |
| AB | 評価 |
| AC | 備考 |

4. V-Z列（質問16-20）にヘッダーだけ設定し、データは空欄のままにする

## 方法B: GASコードを修正（代替案）

もし質問16-20の列が不要な場合は、GASコードを修正して列を削除できます。

### 修正版GASコード（質問16-20を削除）

```javascript
// データを配列に変換（質問16-20を削除）
const row = [
  data.timestamp || Utilities.formatDate(new Date(), 'Asia/Tokyo', 'yyyy-MM-dd HH:mm:ss'),
  data.company || '',
  data.industry || '',
  data.headcount || '',
  data.name || '',
  data.email || '',
  data.answers?.q1 || data.answers?.[1] || '',
  data.answers?.q2 || data.answers?.[2] || '',
  data.answers?.q3 || data.answers?.[3] || '',
  data.answers?.q4 || data.answers?.[4] || '',
  data.answers?.q5 || data.answers?.[5] || '',
  data.answers?.q6 || data.answers?.[6] || '',
  data.answers?.q7 || data.answers?.[7] || '',
  data.answers?.q8 || data.answers?.[8] || '',
  data.answers?.q9 || data.answers?.[9] || '',
  data.answers?.q10 || data.answers?.[10] || '',
  data.answers?.q11 || data.answers?.[11] || '',
  data.answers?.q12 || data.answers?.[12] || '',
  data.answers?.q13 || data.answers?.[13] || '',
  data.answers?.q14 || data.answers?.[14] || '',
  data.answers?.q15 || data.answers?.[15] || '',
  // 質問16-20を削除
  data.total_score || 0,
  data.tier || '',
  data.remarks || ''
];
```

この場合、スプレッドシートの列構造も以下のように調整する必要があります：
- V列: 総合得点
- W列: 評価
- X列: 備考

## 推奨事項

1. **方法A（スプレッドシートの調整）を推奨します**
   - 将来的に質問を追加する可能性を考慮
   - GASコードを変更する必要がない
   - 既存のデータに影響を与えない

2. データの整合性を保つため、変更前にスプレッドシートのバックアップを作成してください

3. 変更後は必ずテストデータを送信して、remarksがAC列に正しく表示されることを確認してください