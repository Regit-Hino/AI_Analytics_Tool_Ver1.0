<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Remarks Browser Test</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #4CAF50;
            border-radius: 8px;
            background: #f0f8ff;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .log {
            background: #333;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
            max-height: 400px;
            overflow-y: auto;
        }
        .highlight {
            background: #ffeb3b;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Remarksé€ä¿¡ãƒ†ã‚¹ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ç‰ˆï¼‰</h1>
    
    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆå†…å®¹</h2>
        <p>ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™ï¼š</p>
        <ul>
            <li>ä¼šç¤¾å: <strong>ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾</strong></li>
            <li>åå‰: <strong>ãƒ–ãƒ©ã‚¦ã‚¶å¤ªéƒ</strong></li>
            <li>ãƒ’ã‚¢ãƒªãƒ³ã‚°ãƒ¡ãƒ¢: <strong>ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®é€ä¿¡ãƒ†ã‚¹ãƒˆã€‚remarksãŒXåˆ—ã«æ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹ã‹ç¢ºèªã€‚</strong></li>
        </ul>
    </div>

    <div class="test-section">
        <button onclick="sendTest()">ğŸš€ ãƒ†ã‚¹ãƒˆé€ä¿¡</button>
        <div id="log" class="log"></div>
    </div>

    <div class="highlight">
        âš ï¸ é€ä¿¡å¾Œã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
        <ol>
            <li>ã€Œãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾ã€ã®è¡ŒãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹</li>
            <li>Xåˆ—ï¼ˆ24åˆ—ç›®ï¼‰ã«ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®é€ä¿¡ãƒ†ã‚¹ãƒˆ...ã€ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹</li>
        </ol>
    </div>

    <script>
        const GAS_URL = 'https://script.google.com/a/macros/regit-technology.com/s/AKfycbwmcnuNAdT7leScIb3JnYPkH2Pye6vN0PruZZZ_3szelb1MczLg0hLmjAxN_Qf5GvBl/exec';
        
        function log(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString('ja-JP');
            logDiv.textContent += `[${time}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function getJSTTimestamp() {
            const now = new Date();
            const jstOffset = 9 * 60;
            const jstTime = new Date(now.getTime() + (jstOffset * 60 * 1000));
            
            const year = jstTime.getUTCFullYear();
            const month = String(jstTime.getUTCMonth() + 1).padStart(2, '0');
            const day = String(jstTime.getUTCDate()).padStart(2, '0');
            const hours = String(jstTime.getUTCHours()).padStart(2, '0');
            const minutes = String(jstTime.getUTCMinutes()).padStart(2, '0');
            const seconds = String(jstTime.getUTCSeconds()).padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }
        
        async function sendTest() {
            log('=== ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            const testData = {
                timestamp: getJSTTimestamp(),
                company: "ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾",
                industry: "IT",
                headcount: "51-100",
                name: "ãƒ–ãƒ©ã‚¦ã‚¶å¤ªéƒ",
                email: "browser-test@example.com",
                answers: {
                    1: 3,
                    2: 3,
                    3: 3,
                    4: 3,
                    5: 3,
                    6: 3,
                    7: 3,
                    8: 3,
                    9: 3,
                    10: 3,
                    11: 3,
                    12: 3,
                    13: 3,
                    14: 3,
                    15: 3
                },
                total_score: 90,
                tier: "â˜…â˜…â˜…",
                remarks: "ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®é€ä¿¡ãƒ†ã‚¹ãƒˆã€‚remarksãŒXåˆ—ã«æ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹ã‹ç¢ºèªã€‚"
            };
            
            log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:');
            log(JSON.stringify(testData, null, 2));
            log('\nremarkså€¤: "' + testData.remarks + '"');
            log('remarksé•·ã•: ' + testData.remarks.length + 'æ–‡å­—');
            
            try {
                log('\né€ä¿¡ä¸­...');
                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify(testData),
                });
                
                log('âœ… é€ä¿¡å®Œäº†ï¼');
                log('ï¼ˆno-corsãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ç¢ºèªã§ãã¾ã›ã‚“ï¼‰');
                log('\nğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼');
                
            } catch (error) {
                log('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message);
            }
        }
    </script>
</body>
</html>